package aoc2024.day20

import aoc2024.Coord
import aoc2024.Grid2d

fun main() {
    actualData.let { data ->
        val grid = Grid2d(data) { it }
        println("Part1 test: ${part1(grid)}") // 1438
    }
}

fun part1(grid: Grid2d<Char>): Int {
    val startPos = grid.getCoords().first { grid[it] == 'S' }
    val (fullPath, cheatsFromPositions) = scanPath(startPos, grid, true)
    val maxTime = fullPath.size - 1
    println("Max time: $maxTime")
    println("Cheat count: " + cheatsFromPositions.values.sumOf { it.size })

    val cheatTimes: List<Int> = cheatsFromPositions.flatMap { (pathCoord, cheatsFromPathCoord) ->
        cheatsFromPathCoord.map { cheat ->
            maxTime - (fullPath.indexOf(cheat.second) - 1 - fullPath.indexOf(pathCoord) - 1)
        }
    }

    return cheatTimes.count { maxTime - it >= 100 }
}

data class ScanResult(val path: List<Coord>, val cheats: Map<Coord, List<Pair<Coord, Coord>>>)

fun scanPath(
    start: Coord,
    g: Grid2d<Char>,
    initialScan: Boolean = false,
    alreadyVisited: Collection<Coord> = setOf(),
): ScanResult {
    val visited = mutableSetOf<Coord>().apply { addAll(alreadyVisited) }
    val queue = ArrayDeque<List<Coord>>()
    val foundCheats = mutableMapOf<Coord, List<Pair<Coord, Coord>>>()

    queue.add(listOf(start))

    while (queue.isNotEmpty()) {
        val path = queue.removeFirst()
        val current = path.last()

        visited.add(current)

        if (g[current] == 'E') return ScanResult(path, foundCheats)

        if (initialScan) {
            val cheats = g.cardinalNeighborsWithinLimits(current) { g[it] == '#' }
                .mapNotNull { checkCheat(current, it, g, path) }
            foundCheats[current] = cheats
        }

        val neighbors = g.cardinalNeighborsWithinLimits(current) { it !in visited && g[it] != '#' }
        for (neighbor in neighbors) {
            queue.add(path + neighbor)
        }
    }

    return ScanResult(listOf(), mapOf())
}

fun checkCheat(orig: Coord, startPos: Coord, g: Grid2d<Char>, path: List<Coord>): Pair<Coord, Coord>? {
    val toTest = when {
        startPos.x == orig.x - 1 -> startPos.left()
        startPos.x == orig.x + 1 -> startPos.right()
        startPos.y == orig.y - 1 -> startPos.down()
        startPos.y == orig.y + 1 -> startPos.up()
        else -> error("Invalid direction")
    }

    if (toTest in g.getCoords() && toTest !in path && (g[toTest] == '.' || g[toTest] == 'E')) return Pair(startPos, toTest)

    return null
}

val testData = """
    ###############
    #...#...#.....#
    #.#.#.#.#.###.#
    #S#...#.#.#...#
    #######.#.#.###
    #######.#.#...#
    #######.#.###.#
    ###..E#...#...#
    ###.#######.###
    #...###...#...#
    #.#####.#.###.#
    #.#...#.#.#...#
    #.#.#.#.#.#.###
    #...#...#...###
    ###############
""".trimIndent().lines()

val actualData = """
    #############################################################################################################################################
    #...#.........................#...#.......#...###.........#...###.....#.......#...#.....#...#.....#...#...#...#...###...#...#...........#...#
    #.#.#.#######################.#.#.#.#####.#.#.###.#######.#.#.###.###.#.#####.#.#.#.###.#.#.#.###.#.#.#.#.#.#.#.#.###.#.#.#.#.#########.#.#.#
    #.#.#.......#.............#...#.#...#.....#.#...#.....#...#.#...#...#...#.....#.#.#...#.#.#...#...#.#.#.#.#.#.#.#.....#...#.#...#.......#.#.#
    #.#.#######.#.###########.#.###.#####.#####.###.#####.#.###.###.###.#####.#####.#.###.#.#.#####.###.#.#.#.#.#.#.###########.###.#.#######.#.#
    #.#.###...#...#.....#.....#...#.....#.....#...#.#.....#...#...#.###.#.....###...#...#.#.#.....#...#.#.#.#.#.#.#.#...........###.#.#...###.#.#
    #.#.###.#.#####.###.#.#######.#####.#####.###.#.#.#######.###.#.###.#.#######.#####.#.#.#####.###.#.#.#.#.#.#.#.#.#############.#.#.#.###.#.#
    #.#.#...#.#...#...#.#.....#...#...#.#.....#...#.#.......#.#...#.....#.#.....#...#...#.#.#...#...#.#.#.#.#.#.#.#.#.###...#...#...#...#.....#.#
    #.#.#.###.#.#.###.#.#####.#.###.#.#.#.#####.###.#######.#.#.#########.#.###.###.#.###.#.#.#.###.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#############.#
    #.#...#...#.#.#...#.#...#.#.#...#...#.#.....#...#...#...#.#.#.........#.#...#...#.....#.#.#.#...#.#.#.#.#.#.#.#.#...#.#...#.#.#.............#
    #.#####.###.#.#.###.#.#.#.#.#.#######.#.#####.###.#.#.###.#.#.#########.#.###.#########.#.#.#.###.#.#.#.#.#.#.#.###.#.#####.#.#.#############
    #.#...#...#.#.#...#.#.#...#.#...#.....#...#...#...#.#...#...#...#.....#.#...#.........#...#.#...#.#.#.#.#.#.#.#.#...#.#.....#.#...#...###...#
    #.#.#.###.#.#.###.#.#.#####.###.#.#######.#.###.###.###.#######.#.###.#.###.#########.#####.###.#.#.#.#.#.#.#.#.#.###.#.#####.###.#.#.###.#.#
    #...#...#...#.###.#.#...#...###.#.#...#...#...#...#...#.....#...#...#.#.#...#...###...#...#.#...#.#.#.#.#.#.#.#.#.....#.....#.#...#.#.#...#.#
    #######.#####.###.#.###.#.#####.#.#.#.#.#####.###.###.#####.#.#####.#.#.#.###.#.###.###.#.#.#.###.#.#.#.#.#.#.#.###########.#.#.###.#.#.###.#
    #.....#.....#...#.#.###.#.###...#.#.#.#.....#.....#...#.....#.###...#.#.#.#...#...#...#.#...#...#.#.#...#.#.#.#...#.........#.#...#.#.#.#...#
    #.###.#####.###.#.#.###.#.###.###.#.#.#####.#######.###.#####.###.###.#.#.#.#####.###.#.#######.#.#.#####.#.#.###.#.#########.###.#.#.#.#.###
    #...#.#...#...#.#.#.#...#...#...#.#.#.#...#.#.......#...#...#.#...#...#.#.#.#.....#...#...#...#.#.#...#...#.#...#.#.#...#...#.#...#.#...#...#
    ###.#.#.#.###.#.#.#.#.#####.###.#.#.#.#.#.#.#.#######.###.#.#.#.###.###.#.#.#.#####.#####.#.#.#.#.###.#.###.###.#.#.#.#.#.#.#.#.###.#######.#
    #...#...#.....#...#.#.....#.#...#.#.#.#.#.#.#.###...#.....#.#.#...#.#...#.#.#...###.....#.#.#.#.#.#...#...#.#...#.#...#...#.#.#.###.#...#...#
    #.#################.#####.#.#.###.#.#.#.#.#.#.###.#.#######.#.###.#.#.###.#.###.#######.#.#.#.#.#.#.#####.#.#.###.#########.#.#.###.#.#.#.###
    #.#...............#.#...#.#.#.#...#.#.#.#...#...#.#...###...#...#.#.#...#.#.#...#...###.#.#.#.#.#...#.....#.#.#...#...#...#.#.#.#...#.#...###
    #.#.#############.#.#.#.#.#.#.#.###.#.#.#######.#.###.###.#####.#.#.###.#.#.#.###.#.###.#.#.#.#.#####.#####.#.#.###.#.#.#.#.#.#.#.###.#######
    #...###...........#...#...#...#...#.#.#.#.....#.#...#...#...#...#.#.....#.#.#...#.#.#...#.#.#.#...#...#.....#...#...#.#.#...#.#.#...#.......#
    #######.#########################.#.#.#.#.###.#.###.###.###.#.###.#######.#.###.#.#.#.###.#.#.###.#.###.#########.###.#.#####.#.###.#######.#
    ###...#.............#.........#...#.#.#.#...#...###.#...#...#...#...#.....#...#.#.#.#...#.#.#.#...#.###...#...#...###...###...#.....#...#...#
    ###.#.#############.#.#######.#.###.#.#.###.#######.#.###.#####.###.#.#######.#.#.#.###.#.#.#.#.###.#####.#.#.#.###########.#########.#.#.###
    #...#...#.....#...#...#.......#.###.#.#.#...#...#...#...#...#...#...#...#...#.#.#.#...#.#.#.#.#...#.#...#...#.#.....###...#...#...#...#...###
    #.#####.#.###.#.#.#####.#######.###.#.#.#.###.#.#.#####.###.#.###.#####.#.#.#.#.#.###.#.#.#.#.###.#.#.#.#####.#####.###.#.###.#.#.#.#########
    #.....#.#...#.#.#...###.......#...#.#.#.#...#.#.#.....#.###.#.###.....#...#.#.#.#...#.#S#...#...#.#.#.#.#...#.#.....#...#...#.#.#...#.......#
    #####.#.###.#.#.###.#########.###.#.#.#.###.#.#.#####.#.###.#.#######.#####.#.#.###.#.#########.#.#.#.#.#.#.#.#.#####.#####.#.#.#####.#####.#
    #.....#.#...#.#...#.#...#...#...#.#.#.#.#...#.#.#...#.#...#.#.#.......#.....#.#.#...#.###.......#.#.#.#.#.#.#.#.#...#...#...#.#.......#.....#
    #.#####.#.###.###.#.#.#.#.#.###.#.#.#.#.#.###.#.#.#.#.###.#.#.#.#######.#####.#.#.###.###.#######.#.#.#.#.#.#.#.#.#.###.#.###.#########.#####
    #.....#.#...#.....#...#...#.....#...#.#.#.###.#.#.#.#.#...#.#.#.......#.#...#.#.#...#.###.###...#.#.#.#.#.#...#...#.....#.###.#.......#.....#
    #####.#.###.#########################.#.#.###.#.#.#.#.#.###.#.#######.#.#.#.#.#.###.#.###.###.#.#.#.#.#.#.###############.###.#.#####.#####.#
    #.....#.....#...#...#...#...#.......#.#.#.#...#.#.#.#.#...#.#...#.....#...#.#.#...#.#.###...#.#.#.#...#...#...#...........#...#.#...#.......#
    #.###########.#.#.#.#.#.#.#.#.#####.#.#.#.#.###.#.#.#.###.#.###.#.#########.#.###.#.#.#####.#.#.#.#########.#.#.###########.###.#.#.#########
    #.........#...#.#.#...#.#.#...#...#.#...#.#...#.#.#...###.#...#.#.......#...#...#...#.#####...#...###.......#...#...#.......#...#.#...#.....#
    #########.#.###.#.#####.#.#####.#.#.#####.###.#.#.#######.###.#.#######.#.#####.#####.###############.###########.#.#.#######.###.###.#.###.#
    #.........#...#.#.#.....#.#.....#...#...#.#...#.#.#.......#...#...#...#.#...#...#.....#########.....#.....###.....#.#.#.....#.....#...#...#.#
    #.###########.#.#.#.#####.#.#########.#.#.#.###.#.#.#######.#####.#.#.#.###.#.###.#############.###.#####.###.#####.#.#.###.#######.#####.#.#
    #.....#...#...#...#.......#...........#.#.#...#.#.#.#.....#.#####.#.#.#.#...#...#.#...#...#####...#.#...#...#...#...#.#...#.#...#...#.....#.#
    #####.#.#.#.###########################.#.###.#.#.#.#.###.#.#####.#.#.#.#.#####.#.#.#.#.#.#######.#.#.#.###.###.#.###.###.#.#.#.#.###.#####.#
    #.....#.#.#.....#.........###...........#.....#...#.#.###.#...#...#.#.#.#.#...#.#...#.#.#.#####...#.#.#.....#...#.....#...#...#...###...#...#
    #.#####.#.#####.#.#######.###.#####################.#.###.###.#.###.#.#.#.#.#.#.#####.#.#.#####.###.#.#######.#########.###############.#.###
    #.#...#.#.#.....#...#...#.....#.................#...#.#...#...#.#...#.#.#...#.#.....#...#.#####...#...#.......#...#...#...#.......###...#...#
    #.#.#.#.#.#.#######.#.#.#######.###############.#.###.#.###.###.#.###.#.#####.#####.#####.#######.#####.#######.#.#.#.###.#.#####.###.#####.#
    #...#.#.#...#.....#...#.........#...............#.....#.#...###...###...#.....#...#.....#.#######...#...#...#...#...#.....#...#...#...#.....#
    #####.#.#####.###.###############.#####################.#.###############.#####.#.#####.#.#########.#.###.#.#.###############.#.###.###.#####
    #.....#.#...#...#.###...#...#...#...............#...#...#...........#.....#...#.#...#...#......E###...#...#...#...#...#.....#.#.....#...#...#
    #.#####.#.#.###.#.###.#.#.#.#.#.###############.#.#.#.#############.#.#####.#.#.###.#.#################.#######.#.#.#.#.###.#.#######.###.#.#
    #.......#.#.#...#.#...#...#...#.............#...#.#...#...#...#...#.#...#...#.#.###.#.......#.........#...#...#.#...#...#...#.#.......#...#.#
    #########.#.#.###.#.#######################.#.###.#####.#.#.#.#.#.#.###.#.###.#.###.#######.#.#######.###.#.#.#.#########.###.#.#######.###.#
    #.........#.#...#.#.#.....................#.#.###.#...#.#.#.#.#.#...###...#...#...#.........#.......#.....#.#.#.#.......#.###.#...#...#.#...#
    #.#########.###.#.#.#.###################.#.#.###.#.#.#.#.#.#.#.###########.#####.#################.#######.#.#.#.#####.#.###.###.#.#.#.#.###
    #...#.....#.....#.#...#.....#.............#...#...#.#.#.#.#.#.#...#.........#...#.....#.....###...#.........#...#.....#.#...#.#...#.#.#.#.###
    ###.#.###.#######.#####.###.#.#################.###.#.#.#.#.#.###.#.#########.#.#####.#.###.###.#.###################.#.###.#.#.###.#.#.#.###
    #...#.###...#...#.....#...#.#.................#...#.#.#.#.#.#.#...#.......#...#.#.....#.#...#...#...#.........#.......#.#...#.#.###.#...#...#
    #.###.#####.#.#.#####.###.#.#################.###.#.#.#.#.#.#.#.#########.#.###.#.#####.#.###.#####.#.#######.#.#######.#.###.#.###.#######.#
    #...#...###...#.#...#.....#.................#.#...#.#...#...#.#.#...#.....#...#.#.###...#...#...#...#.......#.#.......#...#...#.....#...#...#
    ###.###.#######.#.#.#######################.#.#.###.#########.#.#.#.#.#######.#.#.###.#####.###.#.#########.#.#######.#####.#########.#.#.###
    ###.....#...#...#.#...#...#.........###...#...#...#.......###.#.#.#...#...#...#.#.#...#.....#...#.....#.....#...#...#...###.#.........#...###
    #########.#.#.###.###.#.#.#.#######.###.#.#######.#######.###.#.#.#####.#.#.###.#.#.###.#####.#######.#.#######.#.#.###.###.#.###############
    #...#...#.#.#...#...#...#...###...#.....#.......#.#...#...#...#.#.#...#.#.#...#...#...#.....#.....#...#.......#.#.#...#.....#...###...#.....#
    #.#.#.#.#.#.###.###.###########.#.#############.#.#.#.#.###.###.#.#.#.#.#.###.#######.#####.#####.#.#########.#.#.###.#########.###.#.#.###.#
    #.#...#...#.....#...#...........#.....#.........#...#.#.###...#.#.#.#.#.#...#.#...#...#...#.......#.....#...#.#.#...#...#.....#.....#...#...#
    #.###############.###.###############.#.#############.#.#####.#.#.#.#.#.###.#.#.#.#.###.#.#############.#.#.#.#.###.###.#.###.###########.###
    #.....#...#...#...###...............#.#.......#...###...#...#.#.#.#.#...###...#.#.#.....#.#...#...#...#...#...#.#...###.#.###...........#...#
    #####.#.#.#.#.#.###################.#.#######.#.#.#######.#.#.#.#.#.###########.#.#######.#.#.#.#.#.#.#########.#.#####.#.#############.###.#
    #.....#.#...#.#.#.............#.....#.........#.#.......#.#.#...#...#...........#.......#...#.#.#.#.#.#.......#.#...#...#.........#...#.#...#
    #.#####.#####.#.#.###########.#.###############.#######.#.#.#########.#################.#####.#.#.#.#.#.#####.#.###.#.###########.#.#.#.#.###
    #.......#...#...#.....#.....#...#...#...........#.......#.#...#.....#.................#.......#.#...#.#.#.....#.....#...#...#...#.#.#.#...###
    #########.#.#########.#.###.#####.#.#.###########.#######.###.#.###.#################.#########.#####.#.#.#############.#.#.#.#.#.#.#.#######
    #.........#...#.....#...#...#.....#...#.........#.......#...#...#...###...#...###...#.....#.....#.....#.#.###...#.....#...#.#.#.#...#...#...#
    #.###########.#.###.#####.###.#########.#######.#######.###.#####.#####.#.#.#.###.#.#####.#.#####.#####.#.###.#.#.###.#####.#.#.#######.#.#.#
    #...........#...#...#...#.....#...#...#.......#.......#.#...#.....###...#...#.#...#.......#...#...#...#.#.....#...#...#...#...#.#.....#...#.#
    ###########.#####.###.#.#######.#.#.#.#######.#######.#.#.###.#######.#######.#.#############.#.###.#.#.###########.###.#.#####.#.###.#####.#
    #...###...#.....#.#...#.........#...#...#...#...#...#...#...#...#...#.......#.#...............#...#.#...#.......#...#...#.....#.#.#...#.....#
    #.#.###.#.#####.#.#.###################.#.#.###.#.#.#######.###.#.#.#######.#.###################.#.#####.#####.#.###.#######.#.#.#.###.#####
    #.#...#.#.#.....#...#.....#.........###...#.....#.#.....#...#...#.#.#...###.#.#...###...#...#####...#.....#...#...#...#...#...#.#.#...#.....#
    #.###.#.#.#.#########.###.#.#######.#############.#####.#.###.###.#.#.#.###.#.#.#.###.#.#.#.#########.#####.#.#####.###.#.#.###.#.###.#####.#
    #...#...#...#.....#...###...###...#...#...#...###.#.....#.#...#...#...#.#...#.#.#...#.#.#.#...#.......#...#.#.#.....#...#...###...#...#...#.#
    ###.#########.###.#.###########.#.###.#.#.#.#.###.#.#####.#.###.#######.#.###.#.###.#.#.#.###.#.#######.#.#.#.#.#####.#############.###.#.#.#
    ###...#...#...#...#.#...........#.#...#.#...#.....#.#...#.#...#...#.....#...#.#...#...#.#.#...#.........#...#...#...#.....#...#.....#...#.#.#
    #####.#.#.#.###.###.#.###########.#.###.###########.#.#.#.###.###.#.#######.#.###.#####.#.#.#####################.#.#####.#.#.#.#####.###.#.#
    #.....#.#...###.....#.........#...#.....#...#.....#...#.#...#...#.#...#.....#.###.....#...#.............#...#...#.#.....#.#.#.#.......###...#
    #.#####.#####################.#.#########.#.#.###.#####.###.###.#.###.#.#####.#######.#################.#.#.#.#.#.#####.#.#.#.###############
    #.....#.#.............#.......#...#...#...#.#.###.#.....#...#...#.#...#...#...#...#...#...#...#...#...#.#.#.#.#.#.....#.#...#.......###...###
    #####.#.#.###########.#.#########.#.#.#.###.#.###.#.#####.###.###.#.#####.#.###.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#####.#.###########.###.#.###
    ###...#.#...........#...#.......#...#...###...#...#...###...#...#.#.#.....#.#...#.#...#.#...#...#...#.#.#.#.#.#.....#.#.#.....#...#.....#...#
    ###.###.###########.#####.#####.###############.#####.#####.###.#.#.#.#####.#.###.###.#.#############.#.#.#.#.#####.#.#.#.###.#.#.#########.#
    #...#...#.........#.......#...#...........#...#.......#...#...#.#.#.#.....#.#...#...#.#.#.....#.......#...#...#...#...#...###.#.#.#.....#...#
    #.###.###.#######.#########.#.###########.#.#.#########.#.###.#.#.#.#####.#.###.###.#.#.#.###.#.###############.#.###########.#.#.#.###.#.###
    #.#...###.......#.#...#.....#.........#...#.#.#.......#.#.#...#...#.###...#.....#...#...#...#.#.#.....#.......#.#...........#...#...###.#...#
    #.#.###########.#.#.#.#.#############.#.###.#.#.#####.#.#.#.#######.###.#########.#########.#.#.#.###.#.#####.#.###########.###########.###.#
    #...#...#.......#...#...#.....#.....#...###.#.#...#...#.#.#.......#...#...#.......#####.....#.#...###...#.....#.#...........###.......#.#...#
    #####.#.#.###############.###.#.###.#######.#.###.#.###.#.#######.###.###.#.###########.#####.###########.#####.#.#############.#####.#.#.###
    #.....#.#.................#...#.###.....#...#...#.#.#...#.#.......#...#...#.#.....###...#...#...#.......#.......#.........#.....#...#.#.#...#
    #.#####.###################.###.#######.#.#####.#.#.#.###.#.#######.###.###.#.###.###.###.#.###.#.#####.#################.#.#####.#.#.#.###.#
    #.#...#...###...............#...#.....#.#.#.....#.#.#...#.#.......#...#.#...#...#...#.#...#.....#.....#.#...........#...#...#.....#...#.....#
    #.#.#.###.###.###############.###.###.#.#.#.#####.#.###.#.#######.###.#.#.#####.###.#.#.#############.#.#.#########.#.#.#####.###############
    #...#...#.....#.....#.......#.###...#...#.#...#...#.#...#.....###...#...#...###...#...#.#.......#...#.#.#.........#.#.#.#...#...#...........#
    #######.#######.###.#.#####.#.#####.#####.###.#.###.#.#######.#####.#######.#####.#####.#.#####.#.#.#.#.#########.#.#.#.#.#.###.#.#########.#
    #.....#.....#...###...#.....#.#.....#...#...#.#...#.#.#.......#...#...#.....#...#.#.....#.#.....#.#.#.#.#...#.....#...#.#.#...#...#...#...#.#
    #.###.#####.#.#########.#####.#.#####.#.###.#.###.#.#.#.#######.#.###.#.#####.#.#.#.#####.#.#####.#.#.#.#.#.#.#########.#.###.#####.#.#.#.#.#
    #.#...#.....#.#...#...#.......#.....#.#.#...#...#.#.#.#.....#...#.#...#.#.....#.#.#.#...#.#...#...#.#.#.#.#.#.........#...###...#...#...#...#
    #.#.###.#####.#.#.#.#.#############.#.#.#.#####.#.#.#.#####.#.###.#.###.#.#####.#.#.#.#.#.###.#.###.#.#.#.#.#########.#########.#.###########
    #.#.....#...#.#.#...#...............#.#.#.#.....#.#.#.#.....#...#.#...#.#.#.....#.#.#.#.#...#.#...#.#.#.#.#.#.....#...#...#...#...#...###...#
    #.#######.#.#.#.#####################.#.#.#.#####.#.#.#.#######.#.###.#.#.#.#####.#.#.#.###.#.###.#.#.#.#.#.#.###.#.###.#.#.#.#####.#.###.#.#
    #.....#...#.#.#...#...#.......#.......#.#.#...#...#.#.#...#...#.#.#...#.#.#.#.....#.#.#.....#.#...#...#.#.#.#...#.#.....#...#.......#.....#.#
    #####.#.###.#.###.#.#.#.#####.#.#######.#.###.#.###.#.###.#.#.#.#.#.###.#.#.#.#####.#.#######.#.#######.#.#.###.#.#########################.#
    #.....#.###...###...#.#.#...#...###.....#.#...#.###.#.#...#.#.#.#.#.#...#.#.#.#.....#.#...###.#.....###...#.#...#.......#...#.......#.......#
    #.#####.#############.#.#.#.#######.#####.#.###.###.#.#.###.#.#.#.#.#.###.#.#.#.#####.#.#.###.#####.#######.#.#########.#.#.#.#####.#.#######
    #.#...#.#.............#.#.#.........#.....#.....#...#.#...#.#.#.#.#.#...#.#.#.#.#...#...#...#.#.....#...#...#.........#...#.#.....#...#...###
    #.#.#.#.#.#############.#.###########.###########.###.###.#.#.#.#.#.###.#.#.#.#.#.#.#######.#.#.#####.#.#.###########.#####.#####.#####.#.###
    #.#.#.#.#...#...........#.....#.....#.....###...#.#...#...#.#.#.#.#.###.#.#.#.#.#.#...#...#.#.#.......#.#...#.....#...###...#.....#.....#...#
    #.#.#.#.###.#.###############.#.###.#####.###.#.#.#.###.###.#.#.#.#.###.#.#.#.#.#.###.#.#.#.#.#########.###.#.###.#.#####.###.#####.#######.#
    #.#.#...#...#.#...............#...#...#...#...#...#...#.#...#.#.#...#...#.#...#.#...#...#.#.#.#...#...#...#.#...#.#.....#...#.....#.#.......#
    #.#.#####.###.#.#################.###.#.###.#########.#.#.###.#.#####.###.#####.###.#####.#.#.#.#.#.#.###.#.###.#.#####.###.#####.#.#.#######
    #...#...#.....#...............#...#...#.#...#.......#.#.#...#.#.....#...#.#.....#...#...#.#.#...#.#.#...#.#.#...#.#.....#...#.....#.#.#.....#
    #####.#.#####################.#.###.###.#.###.#####.#.#.###.#.#####.###.#.#.#####.###.#.#.#.#####.#.###.#.#.#.###.#.#####.###.#####.#.#.###.#
    #.....#.............###.......#...#...#.#...#.###...#.#...#.#.#.....#...#.#.#...#...#.#...#...#...#...#.#.#.#.#...#...###...#.......#...#...#
    #.#################.###.#########.###.#.###.#.###.###.###.#.#.#.#####.###.#.#.#.###.#.#######.#.#####.#.#.#.#.#.#####.#####.#############.###
    #...#.........#...#.....#...#...#...#.#.#...#...#...#.###...#.#.....#...#.#.#.#.....#...#...#.#...#...#...#.#.#.#...#...###...#...#...#...###
    ###.#.#######.#.#.#######.#.#.#.###.#.#.#.#####.###.#.#######.#####.###.#.#.#.#########.#.#.#.###.#.#######.#.#.#.#.###.#####.#.#.#.#.#.#####
    #...#.###...#.#.#...#...#.#...#...#.#...#.#...#.#...#.......#.....#.#...#.#.#...#.......#.#...###.#.......#.#.#.#.#...#.....#.#.#...#.#.....#
    #.###.###.#.#.#.###.#.#.#.#######.#.#####.#.#.#.#.#########.#####.#.#.###.#.###.#.#######.#######.#######.#.#.#.#.###.#####.#.#.#####.#####.#
    #...#.#...#...#.#...#.#...#...#...#...###.#.#.#.#...#.....#.#.....#.#.#...#.#...#...#...#.###.....#...#...#.#.#.#.#...#...#.#.#.....#.......#
    ###.#.#.#######.#.###.#####.#.#.#####.###.#.#.#.###.#.###.#.#.#####.#.#.###.#.#####.#.#.#.###.#####.#.#.###.#.#.#.#.###.#.#.#.#####.#########
    ###.#.#.#...#...#...#.###...#...#.....#...#.#.#.#...#...#.#.#...#...#.#.###.#.#.....#.#.#...#...#...#.#...#.#.#.#.#...#.#.#.#.#...#.........#
    ###.#.#.#.#.#.#####.#.###.#######.#####.###.#.#.#.#####.#.#.###.#.###.#.###.#.#.#####.#.###.###.#.###.###.#.#.#.#.###.#.#.#.#.#.#.#########.#
    #...#.#...#...###...#.#...#...#...#.....#...#.#.#...#...#.#.###.#.#...#...#...#.....#.#...#...#...###.....#...#...###.#.#...#...#.#...#...#.#
    #.###.###########.###.#.###.#.#.###.#####.###.#.###.#.###.#.###.#.#.#####.#########.#.###.###.#######################.#.#########.#.#.#.#.#.#
    #.....###...#...#.....#.....#.#.#...#...#.#...#.#...#.###.#.#...#.#.#...#.#.........#.###...#...............###.......#...#...###.#.#.#.#.#.#
    #########.#.#.#.#############.#.#.###.#.#.#.###.#.###.###.#.#.###.#.#.#.#.#.#########.#####.###############.###.#########.#.#.###.#.#.#.#.#.#
    #.........#...#...............#.#...#.#...#.#...#.....#...#.#...#.#...#.#.#...#.....#...#...#.....#.......#...#...#.....#...#...#...#...#...#
    #.#############################.###.#.#####.#.#########.###.###.#.#####.#.###.#.###.###.#.###.###.#.#####.###.###.#.###.#######.#############
    #...#...#...#...#.....#...#...#...#.#.#.....#.........#...#.#...#.....#.#.#...#...#...#.#.#...#...#.....#...#...#.#.#...#.....#.............#
    ###.#.#.#.#.#.#.#.###.#.#.#.#.###.#.#.#.#############.###.#.#.#######.#.#.#.#####.###.#.#.#.###.#######.###.###.#.#.#.###.###.#############.#
    ###...#...#...#...###...#...#.....#...#...............###...#.........#...#.......###...#...###.........###.....#...#.....###...............#
    #############################################################################################################################################
""".trimIndent().lines()
